{% extends "base.html" %}

{% block app_content %}
    <h1><a href="{{ url_for('main.manageproducts') }}" style="color: inherit;"><i class="fas fa-arrow-left"></i></a> {{ _('Bearbeiten') }}</h1>
    <form method="post" enctype="multipart/form-data" novalidate>
        {{ form.hidden_tag() }}
        <p>
            {{ form.description.label }}<br>
            {{ form.description(size=32) }}<br>
            {% for error in form.description.errors %}
            <span style="color: red;">[{{ error }}]</span>
            {% endfor %}
        </p>
        <p>
            {{ form.price.label }}<br>
            {{ form.price(size=32) }}<br>
            {% for error in form.price.errors %}
            <span style="color: red;">[{{ error }}]</span>
            {% endfor %}
        </p>
        {% if product.imageUrl %}<p><div class="imagecontainer"><i class="fas fa-times image-delete" onClick="deleteImage()"></i><img class="image" src="{{ url_for('static', filename='images/' + product.imageUrl or '') }}"></div></p>{% endif %}
        <p>
          {{ form.file }}<br>
          {% for error in form.file.errors %}
          <span style="color: red;">[{{ error }}]</span>
          {% endfor %}
        </p>
        <p>{{ form.active() }} {{ form.active.label }}</p>
        <p>{{ form.stock() }} {{ form.stock.label }} <i id="help_stock" data-trigger="hover" title="Hilfe" data-content="{{ _('Wenn der Bestand inaktiv ist werden nur Buchungen von Produkten berÃ¼cksichtigt') }}" class="fa fa-question-circle"></i></p>
        <p>{{ form.highlight() }} {{ form.highlight.label }}</p>
        <p>{{ form.submit() }}</p>
    </form>
{% endblock %}

{% block custom_script %}
  <script>
    $('#help_stock').popover();
    function deleteImage() {
      $.ajax({
          url: '{{ url_for('main.delete_product_image', id=product.id or 0) }}',
          type: 'DELETE',
          success: function(result) {
            location.reload();
          },
          fail: function(result) {
            location.reload();
          }
      });
    }
  </script>
{% endblock %}
