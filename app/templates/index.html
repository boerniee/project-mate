{% extends "base.html" %}

{% block app_content %}
  <h3>{{ ngettext('Genie√üe unser leckeres Produkt', 'Genie√üe eines unserer %(num)s leckeren Produkte', products|length) }}</h3>
  <div class="card-deck">

  {% for product in products %}
  <product-card productid="{{ product.id }}" notificationcallback="show_modal('soos', 'saas')" description="{{ product.description }}" stock="{{ product.stock }}" price="{{ product.getprice() }}" image="{{ url_for('static', filename='images/' + (product.imageUrl or 'default.png')) }}">
  </product-card>
{% endfor %}
</div>

<div class="modal fade" id="resultmodal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">{{ _('SooS') }}</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <div class="modal-body">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal">{{ _('OK') }}</button>
      </div>

    </div>
  </div>
</div>
{% endblock %}

{% block custom_script %}
  <script src="{{url_for('static', filename='js/product.js')}}"></script>
  <script>
    $("#start").addClass('active');
  </script>
  <script>
    function consume(sender) {
      sender.price = "1,29 ‚Ç¨";
      console.log(sender.productId)
      return
      var id = $(sender).data('productid')
      $.post("".replace('id', id).reaplace )
      .done(function(data) {
        var modal = $('#myModal');
        modal.find('.modal-body').text('{{ _('Viel spa√ü mit deinem Produkt!') }}');
        modal.find('.modal-header h4').html('üçªüéâ');
        modal.modal('toggle');
        $('#stock-'+id).text(data['stock']);
        if(data['stock'] === 0 && data['active']) {
          location.reload();
        }
      })
      .fail(function() {
        var modal = $('#myModal');
        modal.find('.modal-body').text('{{ _('Awups, da ist etwas schief gelaufen!') }}');
        modal.find('.modal-header h4').html('üò©üò©');
        modal.modal('toggle');
      });
    }
    $( ".card" ).hover(
      function() {
        $(this).addClass('shadow');
      }, function() {
        $(this).removeClass('shadow');
      }
    );
  </script>
{% endblock %}
